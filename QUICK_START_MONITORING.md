# ‚ö° –ë–´–°–¢–†–´–ô –°–¢–ê–†–¢: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

## üéØ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –¥–ª—è —Ç–µ–±—è

### 1. ‚úÖ Healthcheck endpoint
**URL:** https://functions.poehali.dev/fafd6cc9-8170-405d-b2b9-d282d190b762

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
- ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (JWT_SECRET, DATABASE_URL)

**–ü–æ–ø—Ä–æ–±—É–π –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:**
```bash
curl https://functions.poehali.dev/fafd6cc9-8170-405d-b2b9-d282d190b762
```

–û—Ç–≤–µ—Ç:
```json
{
  "status": "healthy",
  "timestamp": "2025-11-10T12:00:00",
  "components": {
    "database": {
      "status": "healthy",
      "connection": "ok"
    },
    "environment": {
      "status": "healthy"
    }
  }
}
```

---

## üöÄ –ß–¢–û –î–ï–õ–ê–¢–¨ –î–ê–õ–¨–®–ï (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É)

### üìä 1. –ù–∞—Å—Ç—Ä–æ–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (10 –º–∏–Ω—É—Ç)

**–í–∞—Ä–∏–∞–Ω—Ç –ê: UptimeRobot (–ø—Ä–æ—â–µ –≤—Å–µ–≥–æ)**

1. –ó–∞–π–¥–∏ –Ω–∞ https://uptimerobot.com
2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (email + –ø–∞—Ä–æ–ª—å)
3. –°–æ–∑–¥–∞–π –º–æ–Ω–∏—Ç–æ—Ä:
   ```
   Monitor Type: HTTPS
   URL: https://functions.poehali.dev/fafd6cc9-8170-405d-b2b9-d282d190b762
   Interval: 5 –º–∏–Ω—É—Ç
   Alert Contacts: —Ç–≤–æ—è –ø–æ—á—Ç–∞
   ```
4. –ì–æ—Ç–æ–≤–æ! –ë—É–¥–µ—à—å –ø–æ–ª—É—á–∞—Ç—å –ø–∏—Å—å–º–∞ –µ—Å–ª–∏ —Å–∞–π—Ç —É–ø–∞–¥—ë—Ç

**–í–∞—Ä–∏–∞–Ω—Ç –ë: Sentry (–¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫)**

–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤ `DEPLOYMENT_GUIDE.md` (—Ä–∞–∑–¥–µ–ª 2)

---

### üíæ 2. –ù–∞—Å—Ç—Ä–æ–π —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (15 –º–∏–Ω—É—Ç)

#### –í–∞—Ä–∏–∞–Ω—Ç –ê: –Ø–Ω–¥–µ–∫—Å.–û–±–ª–∞–∫–æ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

–ï—Å–ª–∏ —Ç–≤–æ—è –ë–î –≤ –Ø–Ω–¥–µ–∫—Å.–û–±–ª–∞–∫–µ:
1. –ó–∞–π–¥–∏ –≤ –∫–æ–Ω—Å–æ–ª—å ‚Üí Managed Service for PostgreSQL
2. –í—ã–±–µ—Ä–∏ —Å–≤–æ—é –ë–î
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏:
   - –í–∫–ª—é—á–∏—Ç—å: –î–ê
   - –í—Ä–µ–º—è: 03:00
   - –•—Ä–∞–Ω–∏—Ç—å: 7 –¥–Ω–µ–π
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å

**–ì–æ—Ç–æ–≤–æ! –í—Å—ë –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.**

#### –í–∞—Ä–∏–∞–Ω—Ç –ë: –†—É—á–Ω–æ–π —Å–∫—Ä–∏–ø—Ç (–µ—Å–ª–∏ self-hosted)

–Ø —Å–æ–∑–¥–∞–ª –≥–æ—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã:

**–°–¥–µ–ª–∞—Ç—å backup:**
```bash
# –û–¥–∏–Ω —Ä–∞–∑ –Ω–∞—Å—Ç—Ä–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
export DATABASE_URL="—Ç–≤–æ–π_DATABASE_URL_–∏–∑_—Å–µ–∫—Ä–µ—Ç–æ–≤"

# –°–æ–∑–¥–∞—Ç—å backup
chmod +x scripts/backup_db.sh
./scripts/backup_db.sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å–æ–∑–¥–∞–ª—Å—è
ls -lh /backups/postgres/
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å:**
```bash
# –û—Ç–∫—Ä–æ–π crontab
crontab -e

# –î–æ–±–∞–≤—å —Å—Ç—Ä–æ–∫—É (–∑–∞–ø—É—Å–∫ –≤ 3:00 –Ω–æ—á–∏)
0 3 * * * export DATABASE_URL="—Ç–≤–æ–π_url" && /path/to/scripts/backup_db.sh
```

**–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–∑ backup (–µ—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è):**
```bash
./scripts/restore_db.sh /backups/postgres/backup_20250110_030000.sql.gz
```

---

### üî• 3. –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (20 –º–∏–Ω—É—Ç)

–Ø —Å–æ–∑–¥–∞–ª –≥–æ—Ç–æ–≤—ã–π —Ç–µ—Å—Ç `load-test.js`

**–£—Å—Ç–∞–Ω–æ–≤–∏ k6:**
```bash
# macOS
brew install k6

# Linux
sudo apt-get install k6

# Windows
choco install k6
```

**–ó–∞–ø—É—Å—Ç–∏ —Ç–µ—Å—Ç:**
```bash
k6 run load-test.js
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–∫–∞–∂–µ—Ç:**
```
‚úì –≥–ª–∞–≤–Ω–∞—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞ (200)
‚úì API —Ä–∞–±–æ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω
‚úì CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω

http_req_duration...: avg=245ms  p(95)=450ms  ‚úÖ
http_req_failed.....: 0.2%  ‚úÖ
checks..............: 97.5%  ‚úÖ

‚úÖ –¢–ï–°–¢ –ü–†–û–ô–î–ï–ù –£–°–ü–ï–®–ù–û!
–°–∞–π—Ç –≥–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É –≤ production.
```

–ï—Å–ª–∏ —Ç–µ—Å—Ç –ù–ï –ø—Ä–æ—à—ë–ª ‚Äî –Ω–∞–ø–∏—à–∏ –º–Ω–µ, —Ä–∞–∑–±–µ—Ä—ë–º—Å—è —á—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å.

---

## üìã –ß–ï–ö–õ–ò–°–¢ –ü–ï–†–ï–î –ó–ê–ü–£–°–ö–û–ú

–û—Ç–º–µ—Ç—å —á—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [ ] UptimeRobot –∏–ª–∏ –¥—Ä—É–≥–æ–π uptime monitor –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Healthcheck endpoint –¥–æ–±–∞–≤–ª–µ–Ω –≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [ ] –ü–æ–ª—É—á–∞—é —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –Ω–∞ email/telegram

### –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ backup —Å–æ–∑–¥–∞—ë—Ç—Å—è (–∑–∞–ø—É—Å—Ç–∏–ª –≤—Ä—É—á–Ω—É—é)
- [ ] –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ –º–æ–≥—É –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å (—Ç–µ—Å—Ç–æ–≤–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –ù–∞–≥—Ä—É–∑–æ—á–Ω—ã–π —Ç–µ—Å—Ç –ø—Ä–æ–π–¥–µ–Ω (k6 run load-test.js)
- [ ] 95% –∑–∞–ø—Ä–æ—Å–æ–≤ < 500ms
- [ ] –û—à–∏–±–æ–∫ < 1%

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- [ ] JWT_SECRET —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ production —Å–µ–∫—Ä–µ—Ç–∞—Ö
- [ ] DATABASE_URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- [ ] HTTPS –≤–µ–∑–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üÜò –ë–´–°–¢–†–ê–Ø –ü–û–ú–û–©–¨

### –°–∞–π—Ç —É–ø–∞–ª - —á—Ç–æ –¥–µ–ª–∞—Ç—å?

1. **–ü—Ä–æ–≤–µ—Ä—å healthcheck:**
   ```bash
   curl https://functions.poehali.dev/fafd6cc9-8170-405d-b2b9-d282d190b762
   ```

2. **–ï—Å–ª–∏ –±–∞–∑–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞:**
   - –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ –ë–î
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏ –∏–∑ backup –µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–Ω–æ

3. **–ï—Å–ª–∏ –≤—Å—ë "healthy" –Ω–æ —Å–∞–π—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
   - –ü—Ä–æ–≤–µ—Ä—å DNS
   - –ü—Ä–æ–≤–µ—Ä—å CDN/–ø—Ä–æ–∫—Å–∏ –µ—Å–ª–∏ –µ—Å—Ç—å

### –ù—É–∂–Ω–∞ –ø–æ–º–æ—â—å?

- üìñ –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: `DEPLOYMENT_GUIDE.md`
- üîç –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞—É–¥–∏—Ç: `TECHNICAL_AUDIT_REPORT.md`
- ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ: `FIXES_COMPLETED.md`

---

## ‚è±Ô∏è –°–ö–û–õ–¨–ö–û –ó–ê–ô–ú–Å–¢

| –ó–∞–¥–∞—á–∞ | –í—Ä–µ–º—è | –°–ª–æ–∂–Ω–æ—Å—Ç—å |
|--------|-------|-----------|
| UptimeRobot | 10 –º–∏–Ω | üü¢ –õ–µ–≥–∫–æ |
| Backup (–Ø–Ω–¥–µ–∫—Å) | 5 –º–∏–Ω | üü¢ –õ–µ–≥–∫–æ |
| Backup (—Å–∫—Ä–∏–ø—Ç) | 15 –º–∏–Ω | üü° –°—Ä–µ–¥–Ω–µ |
| Sentry | 20 –º–∏–Ω | üü° –°—Ä–µ–¥–Ω–µ |
| k6 —Ç–µ—Å—Ç | 20 –º–∏–Ω | üü° –°—Ä–µ–¥–Ω–µ |
| **–ò–¢–û–ì–û** | **1 —á–∞—Å** | |

**–ú–∏–Ω–∏–º—É–º –¥–ª—è –∑–∞–ø—É—Å–∫–∞:** UptimeRobot + Backup = 15 –º–∏–Ω—É—Ç

---

## üéâ –ì–û–¢–û–í–û!

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ–∫–ª–∏—Å—Ç–∞ –º–æ–∂–µ—à—å —Å–º–µ–ª–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤ production!

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –≤–æ–ø—Ä–æ—Å—ã ‚Äî –ø–∏—à–∏, –ø–æ–º–æ–≥—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è.

**–£–¥–∞—á–∏ —Å –∑–∞–ø—É—Å–∫–æ–º! üöÄ**
