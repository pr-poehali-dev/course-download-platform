# –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–µ–≤—å—é –¥–ª—è —Ä–∞–±–æ—Ç

–°–∫—Ä–∏–ø—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–µ–≤—å—é (—Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü "–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ" –∏ "–í–≤–µ–¥–µ–Ω–∏–µ") –∏–∑ Word –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ ZIP –∞—Ä—Ö–∏–≤–∞—Ö.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–∞
- **Windows**: Microsoft Word —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- **Mac/Linux**: LibreOffice —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

### Python
- Python 3.8 –∏–ª–∏ –Ω–æ–≤–µ–µ

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Python –±–∏–±–ª–∏–æ—Ç–µ–∫

–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É –≤ –ø–∞–ø–∫–µ `local_scripts/` –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

**Windows:**
```bash
pip install psycopg2-binary requests python-docx Pillow boto3 pywin32 pyautogui PyMuPDF
```

**Mac/Linux:**
```bash
pip3 install psycopg2-binary requests python-docx Pillow boto3 PyMuPDF
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –ø–∞–ø–∫–µ `local_scripts/` —Å–æ —Å–ª–µ–¥—É—é—â–∏–º —Å–æ–¥–µ—Ä–∂–∏–º—ã–º:

```
DATABASE_URL=postgresql://user:password@host:port/database
YANDEX_S3_KEY_ID=–≤–∞—à_–∫–ª—é—á_s3
YANDEX_S3_SECRET_KEY=–≤–∞—à_—Å–µ–∫—Ä–µ—Ç–Ω—ã–π_–∫–ª—é—á_s3
```

**–ì–¥–µ –≤–∑—è—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ:**
- `DATABASE_URL` - —Å—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL (–ø–æ–ø—Ä–æ—Å–∏ —É –Æ—Ä—ã)
- `YANDEX_S3_KEY_ID` - –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞ –∫ Yandex Object Storage (–ø–æ–ø—Ä–æ—Å–∏ —É –Æ—Ä—ã)
- `YANDEX_S3_SECRET_KEY` - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞ (–ø–æ–ø—Ä–æ—Å–∏ —É –Æ—Ä—ã)

## –ó–∞–ø—É—Å–∫

### Windows

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É (Win + R ‚Üí `cmd`)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É —Å–æ —Å–∫—Ä–∏–ø—Ç–æ–º:
   ```bash
   cd –ø—É—Ç—å\–∫\–ø—Ä–æ–µ–∫—Ç—É\local_scripts
   ```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:
   ```bash
   python generate_previews.py
   ```

### Mac/Linux

1. –û—Ç–∫—Ä–æ–π—Ç–µ Terminal
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É —Å–æ —Å–∫—Ä–∏–ø—Ç–æ–º:
   ```bash
   cd –ø—É—Ç—å/–∫/–ø—Ä–æ–µ–∫—Ç—É/local_scripts
   ```
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç:
   ```bash
   python3 generate_previews.py
   ```

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. **–°–∫—Ä–∏–ø—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –ë–î** –∏ –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ —Ä–∞–±–æ—Ç—ã –±–µ–∑ –ø—Ä–µ–≤—å—é
2. **–°–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ** - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–∫–æ–ª—å–∫–æ —Ä–∞–±–æ—Ç –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ
3. –î–ª—è –∫–∞–∂–¥–æ–π —Ä–∞–±–æ—Ç—ã:
   - –°–∫–∞—á–∏–≤–∞–µ—Ç ZIP –∞—Ä—Ö–∏–≤
   - –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç –∏ –Ω–∞—Ö–æ–¥–∏—Ç Word —Ñ–∞–π–ª
   - **–û—Ç–∫—Ä—ã–≤–∞–µ—Ç Word** –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
   - **–î–µ–ª–∞–µ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç—ã** –ø–µ—Ä–≤—ã—Ö 2 —Å—Ç—Ä–∞–Ω–∏—Ü (–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ + –í–≤–µ–¥–µ–Ω–∏–µ)
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –≤ S3 —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
   - –û–±–Ω–æ–≤–ª—è–µ—Ç `preview_image_url` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
4. **–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ç–æ–≥–∏** - —Å–∫–æ–ª—å–∫–æ —É—Å–ø–µ—à–Ω–æ, —Å–∫–æ–ª—å–∫–æ –æ—à–∏–±–æ–∫

## –ü—Ä–∏–º–µ—Ä—ã –≤—ã–≤–æ–¥–∞

```
================================================================================
–ì–ï–ù–ï–†–ê–¢–û–† –ü–†–ï–í–¨–Æ –î–õ–Ø –†–ê–ë–û–¢
================================================================================

–ü–æ–ª—É—á–∞—é —Å–ø–∏—Å–æ–∫ —Ä–∞–±–æ—Ç –±–µ–∑ –ø—Ä–µ–≤—å—é...

–ù–∞–π–¥–µ–Ω–æ —Ä–∞–±–æ—Ç –±–µ–∑ –ø—Ä–µ–≤—å—é: 25

–û–±—Ä–∞–±–æ—Ç–∞—Ç—å 25 —Ä–∞–±–æ—Ç? (–¥–∞/–Ω–µ—Ç): –¥–∞

[1/25]
================================================================================
–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–±–æ—Ç—ã #4383: –ê–≤—Ç–æ–º–∞—Ç–∏–∫–∞ —Ñ–∏–¥–µ—Ä–∞ 10–∫–í —Ç—è–≥–æ–≤–æ–π –ø–æ–¥—Å—Ç–∞–Ω—Ü–∏–∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ç–æ–∫–∞
================================================================================
  –°–∫–∞—á–∏–≤–∞—é ZIP...
  –†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞—é ZIP...
  –ù–∞–π–¥–µ–Ω —Ñ–∞–π–ª: –ê–≤—Ç–æ–º–∞—Ç–∏–∫–∞ —Ñ–∏–¥–µ—Ä–∞.docx
  –û—Ç–∫—Ä—ã–≤–∞—é Word...
  ‚úì –°–∫—Ä–∏–Ω—à–æ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã 1 —Å–æ—Ö—Ä–∞–Ω–µ–Ω
  ‚úì –°–∫—Ä–∏–Ω—à–æ—Ç —Å—Ç—Ä–∞–Ω–∏—Ü—ã 2 —Å–æ—Ö—Ä–∞–Ω–µ–Ω
  –ó–∞–≥—Ä—É–∂–∞—é —Å–∫—Ä–∏–Ω—à–æ—Ç 1 –≤ S3...
  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ: https://storage.yandexcloud.net/kyra/previews/work_4383_page_0.png
  –ó–∞–≥—Ä—É–∂–∞—é —Å–∫—Ä–∏–Ω—à–æ—Ç 2 –≤ S3...
  ‚úì –ó–∞–≥—Ä—É–∂–µ–Ω–æ: https://storage.yandexcloud.net/kyra/previews/work_4383_page_1.png
  –û–±–Ω–æ–≤–ª—è—é –ë–î...
  ‚úì –ü—Ä–µ–≤—å—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ –≤ –ë–î

‚úÖ –†–∞–±–æ—Ç–∞ #4383 –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ!

...

================================================================================
–ò–¢–û–ì–ò
================================================================================
‚úÖ –£—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ: 23
‚ùå –û—à–∏–±–æ–∫: 2
üìä –í—Å–µ–≥–æ: 25
```

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### "win32com –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω" (Windows)
```bash
pip install pywin32
pip install pyautogui
```

### "LibreOffice –Ω–µ –Ω–∞–π–¥–µ–Ω" (Mac/Linux)
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ LibreOffice:
- **Mac**: `brew install libreoffice`
- **Ubuntu**: `sudo apt-get install libreoffice`

### "PyMuPDF –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
```bash
pip install PyMuPDF
```

### "DATABASE_URL –Ω–µ —É–∫–∞–∑–∞–Ω"
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (—Å–º. –®–∞–≥ 2)

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–ê–ñ–ù–û**: –§–∞–π–ª `.env` —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ!
- –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –µ–≥–æ –≤ Git
- –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ –Ω–∏–∫–æ–º—É
- `.env` —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.gitignore`

## –í–æ–ø—Ä–æ—Å—ã

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –Ω–∞–ø–∏—à–∏ –Æ—Ä–µ –≤ —á–∞—Ç, –æ–Ω –ø–æ–º–æ–∂–µ—Ç!
